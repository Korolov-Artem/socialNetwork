{"ast":null,"code":"import _objectSpread from\"/Users/jestex/Documents/React/git/socialNetwork/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{stopSubmit}from\"redux-form\";import{authAPI}from\"../api/api\";var SET_USER_DATA=\"SET_USER_DATA\";var SET_IS_FETCHING=\"SET_IS_FETCHING\";var initialState={userId:null,email:null,login:null,isFetching:false,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.data);case SET_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});default:return state;}};export var setUserData=function setUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,data:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var setIsFetching=function setIsFetching(isFetching){return{type:SET_IS_FETCHING,isFetching:isFetching};};export var LogedIn=function LogedIn(){return function(dispatch){dispatch(setIsFetching(true));return authAPI.getAuth().then(function(data){dispatch(setIsFetching(false));var _data$data=data.data,id=_data$data.id,email=_data$data.email,login=_data$data.login;if(data.resultCode===0){dispatch(setUserData(id,email,login,true));}});};};export var login=function login(email,password,rememberMe){return function(dispatch){authAPI.login(email,password,rememberMe).then(function(response){dispatch(setIsFetching(false));if(response.data.resultCode===0){dispatch(LogedIn());}else{var message=response.data.messages.length>0?response.data.messages[0]:'Some error';var action=stopSubmit('login',{_error:message});dispatch(action);}});};};export var logout=function logout(dispatch){authAPI.logout().then(function(response){dispatch(setIsFetching(false));if(response.data.resultCode===0){dispatch(setUserData(null,null,null,false));}});};export default authReducer;","map":{"version":3,"names":["stopSubmit","authAPI","SET_USER_DATA","SET_IS_FETCHING","initialState","userId","email","login","isFetching","isAuth","authReducer","state","arguments","length","undefined","action","type","_objectSpread","data","setUserData","setIsFetching","LogedIn","dispatch","getAuth","then","_data$data","id","resultCode","password","rememberMe","response","message","messages","_error","logout"],"sources":["/Users/jestex/Documents/React/git/socialNetwork/src/redux/auth-reducer.js"],"sourcesContent":["import { stopSubmit } from \"redux-form\";\nimport { authAPI } from \"../api/api\";\n\nconst SET_USER_DATA = \"SET_USER_DATA\";\nconst SET_IS_FETCHING = \"SET_IS_FETCHING\";\n\nlet initialState = {\n  userId: null,\n  email: null,\n  login: null,\n  isFetching: false,\n  isAuth: false,\n};\n\nconst authReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER_DATA:\n      return {\n        ...state,\n        ...action.data,\n      };\n    case SET_IS_FETCHING:\n      return { ...state, isFetching: action.isFetching };\n    default:\n      return state;\n  }\n};\n\nexport const setUserData = (userId, email, login, isAuth) => ({\n  type: SET_USER_DATA,\n  data: { userId, email, login, isAuth },\n});\n\nexport const setIsFetching = (isFetching) => ({\n  type: SET_IS_FETCHING,\n  isFetching,\n});\n\nexport const LogedIn = () => (dispatch) => {\n    dispatch(setIsFetching(true));\n    return authAPI.getAuth().then((data) => {\n      dispatch(setIsFetching(false));\n      let { id, email, login } = data.data;\n      if (data.resultCode === 0) {\n        dispatch(setUserData(id, email, login, true ));\n      }\n    });\n  };\n\n\nexport const login = (email, password, rememberMe) => (dispatch) => {\n  authAPI.login(email, password, rememberMe).then((response) => {\n    dispatch(setIsFetching(false));\n    if (response.data.resultCode === 0) {\n     dispatch(LogedIn()) \n    } else {\n      let message = response.data.messages.length > 0 ? response.data.messages[0] : 'Some error';\n      let action = stopSubmit('login', {_error: message})\n      dispatch(action)\n    }\n  });\n};\n\nexport const logout = (dispatch) => {\n  authAPI.logout().then((response) => {\n    dispatch(setIsFetching(false));\n    if (response.data.resultCode === 0) {\n      dispatch(setUserData(null, null, null, false ));\n    }\n  });\n};\n\nexport default authReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}